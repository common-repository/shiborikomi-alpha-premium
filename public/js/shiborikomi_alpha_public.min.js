var checkCategory=[],categoryMaster=[],dataList=[],dataListDefault=[],sortDataList=[],sortNum=0,isShowDetailLink=!1,detailLinkColor="",officialLinkColor="",isAllDisplay=!1,shouldAutoSearch=!1,mSkew="",CATEGORY_MIN_IDX=9,CATEGORY_DISPLAY_MAX_COUNT=5,resultTheme="",pickupCategory1="",pickupCategory2="",shouldShowPickup=!1,shouldShowStarRating=!1,shouldShowResultDesc=!1;function changeColor(e){var t=document.getElementById(e);if(t.classList)t.parentNode.classList.toggle("is-checked");else{var a=t.className.split(" "),r=a.indexOf("is-checked");0<=r?a.splice(r,1):a.push("is-checked"),t.className=a.join(" ")}}function selectedCategoryIsEmpty(){var e=!0;for(var t in checkCategory)e&=0==checkCategory[t].length;return e}function resultSearchAndShow(e){if(checkCategoryAllInsert(e),selectedCategoryIsEmpty()){var t=dataList;isAllDisplay=!0}else t=searchResult();var a=listToKeyMap(t);0<sortDataList.length&&(a=sortBySetting(a)),parseResultToHtml(a)}function onChangeSelect(e,t){var a=t.selectedIndex;checkCategoryUpdate(e,t.options[a].value,!0);var r=listToKeyMap(searchResult());0<sortDataList.length&&(r=sortBySetting(r)),shouldAutoSearch&&parseResultToHtml(r),isAllDisplay=!1}function onCheckBox(e,t){checkCategoryUpdate(e,t,!1);var a=listToKeyMap(searchResult());0<sortDataList.length&&(a=sortBySetting(a)),shouldAutoSearch&&parseResultToHtml(a),isAllDisplay=!1}function onSearch(){if(selectedCategoryIsEmpty()){var e=dataList;isAllDisplay=!0}else e=searchResult();var t=listToKeyMap(e);0<sortDataList.length&&(t=sortBySetting(t)),parseResultToHtml(t)}function changeSort(e){if(sortNum=e.selectedIndex,isAllDisplay)allDisplay();else{var t=listToKeyMap(searchResult());0<sortDataList.length&&(t=sortBySetting(t)),parseResultToHtml(t)}}function allDisplay(){var e=listToKeyMap(dataList);0<sortDataList.length&&(e=sortBySetting(e)),parseResultToHtml(e),isAllDisplay=!0}function sortBySetting(e){if(0==sortNum){var t=[];for(var a in dataListDefault)for(var r in e)e[r]["項目名"]==dataListDefault[a][0]&&t.push(e[r]);return t}var s=e,l=sortDataList[sortNum].sort_column,i=sortDataList[sortNum].sort_order,c=sortDataList[sortNum].order_by;return s.sort(function(e,t){var a=e.key[l],r=t.key[l],s=a.indexOf(";;");-1!=s&&(a=a.slice(0,s));var o=r.indexOf(";;");return-1!=o&&(r=r.slice(0,o)),1==c&&(a=parseInt(a.replace(/[^0-9]/g,""),10),r=parseInt(r.replace(/[^0-9]/g,""),10)),"asc"==i?a<r?-1:r<a?1:0:r<a?-1:a<r?1:0}),s}function searchResult(){var e=!0;for(var t in checkCategory)e&=0==checkCategory[t].length;if(e)return[];var a=dataList;for(var t in checkCategory){var r=[];if(0!=checkCategory[t].length){for(var s=0,o=!1,l=0;l<categoryMaster.length;l++)categoryMaster[l]==t&&(s=l,"こだわり検索"==t&&(o=!0));for(var i=a.length-1;0<=i;i--){var c=!1;for(var n in checkCategory[t]){var u=a[i][s];if(-1!=u.indexOf(";;")&&(u=u.split(";;")[1]),-1!=u.indexOf("__")){var h=u.split("__")[0]==checkCategory[t][n];c=c||h}else{if(o)c=-1!=u.indexOf(checkCategory[t][n]);else h=u==checkCategory[t][n];c=c||h}if(c)break}c&&r.push(a[i])}a=r}}return a}function checkCategoryUpdate(e,t,a){checkCategory[e]||(checkCategory[e]=[]),a&&(checkCategory[e]=[]);for(var r=0;r<checkCategory[e].length;r++)if(checkCategory[e][r]==t)return void checkCategory[e].splice(r,1);-1==t.indexOf("選択")&&checkCategory[e].push(t)}function checkCategoryAllInsert(e){for(category in checkCategory=[],e){checkCategory[category]||(checkCategory[category]=[]);for(var t=0;t<e[category].length;t++){var a=e[category][t];-1==a.indexOf("選択")&&checkCategory[category].push(a)}}}function listToKeyMap(e){var t=[];for(recordIdx in e){var a=[];for(categoryIdx in categoryMaster)categoryIdx>=CATEGORY_MIN_IDX?(a.key||(a.key=[]),a.key[categoryMaster[categoryIdx]]=e[recordIdx][categoryIdx]):a[categoryMaster[categoryIdx]]=e[recordIdx][categoryIdx];t.push(a)}return t}function getValueByRegex(e){var t=e;return-1!=e.indexOf(";;")&&(t=e.split(";;")[0]),-1!=e.indexOf("__")&&(t=e.split("__")[0]),t}function htmlTableColumns(e){var t="",a=0;for(var r in e)if("こだわり検索"!=r){if(CATEGORY_DISPLAY_MAX_COUNT<=a)break;t+="<dl><dt>"+r+"</dt><dd>"+getValueByRegex(e[r])+"</dd></dl>",a++}return t}function htmlPickupCategory(e,t,a,r){if(!t)return"";var s="";if("-"!=pickupCategory1&&e[pickupCategory1]&&(s+=pickupCategory1+":"+getValueByRegex(e[pickupCategory1])),"-"!=pickupCategory2&&e[pickupCategory2]&&(s+=", "+pickupCategory2+":"+getValueByRegex(e[pickupCategory2])),""==s)return"";var o='<div class="search-result-pickup">';return o+="<p>"+s+"</p>",o+="</div>"}function htmlResultStar(e,t){if(!t||""==e)return"";var a='<div class="search-result-star">';return a+='<div class="star-rating">',a+='<div class="star-rating-front" style="width:'+20*e+'%;">★★★★★</div>',a+='<div class="star-rating-back">★★★★★</div>',a+="</div>",a+='<p class="star_num">'+e+"</p>",a+="</div>"}function htmlDetailLink(e,t,a,r,s){if(!e)return"";var o="";a&&(o+='onClick="'+a+'"');var l='<a href="'+t+'" style="background-color:'+r+';" '+o+'class="search-result-link';return"none"!=s&&(l+=" "+s),l+='" target="_brank">詳しくはこちら</a>'}function htmlOfficialLink(e,t,a,r){var s="",o="";return t&&(o+='onClick="'+t+'"'),s+='<a href="'+e+'" style="background-color:'+a+';" '+o+'class="search-result-link',"none"!=r&&(s+=" "+r),s+='" target="brank">公式ページはこちら</a>'}function htmlSortForm(e){var t=!1,a='<form class="search-result-order" action="" method="get">';a+="<span>並び替え: </span>",a+='<select name="order_number" onChange="changeSort(this);">';for(var r=0;r<e.length;r++)t=!0,a+='<option value="'+r+'"',r==sortNum&&(a+=" selected"),a+=">"+e[r].box_name+"</option>";return a+="</select></form>",t?a:""}function htmlDescription(e,t,a){if(!a)return"";if(!e&&!t)return"";var r='<div class="search-result-block4">';return e&&(r+='<p class="des-title">'+e+"</p>"),t&&(r+='<p class="des-text">'+t+"</p>"),r+="</div>"}function htmlImgBlock(e,t){return html='<a href="'+t+'" target="_blank">',html+='<div class="search-result-contain" style="background-image:url(\''+e+"');\"></div>",html+="</a>",html}function parseResultToHtml(e){var t='<div class="search-result-box">';for(var a in t+='<div class="search-form-title">検索結果('+e.length+"件)</div>",t+='<div class="search-result-container">',t+=htmlSortForm(sortDataList),t+='<ul class="search-result-container">',e){var r=e[a];t+='<li class="search-form-fadein">',t+='<div class="search-result-block">',t+='<div class="search-result-adjustOld">',t+='<div class="search-result-block1">',t+='<div class="search-result-title">',t+="<p>"+r["項目名"]+"</p>",t+="</div>",t+='<div class="search-result-info">',t+=htmlResultStar(r["評価値"],shouldShowStarRating),t+=htmlPickupCategory(r.key,shouldShowPickup,pickupCategory1,pickupCategory2),t+="</div>",t+="</div>",t+='<div class="search-result-block2">',t+=htmlImgBlock(r["画像"],r["公式リンク"]),t+="</div>",t+="</div>",t+='<div class="search-result-adjustSP">',t+='<div class="search-result-block3">',t+='<div class="search-result-category">',t+=htmlTableColumns(r.key),t+="</div>",t+="</div>",t+=htmlDescription(r["説明タイトル"],r["説明本文"],shouldShowResultDesc),t+="</div>",t+='<div class="search-result-link-area">',t+=htmlDetailLink(isShowDetailLink,r["詳細リンク"],r["詳細リンクonClick"],detailLinkColor,mSkew),t+=htmlOfficialLink(r["公式リンク"],r["公式リンクonClick"],officialLinkColor,mSkew),t+="</div>",t+="</div>",t+="</li>"}t+="</ul>",t+="</div></div>",document.getElementById("checkbox_result_area").innerHTML=t}window.onload=function(){for(var e=document.getElementsByClassName("search-form-block"),t=0;t<e.length;t++){var a=e[t].getElementsByTagName("input")[0];a.checked&&a.parentNode.classList.toggle("is-checked")}categoryMaster=data_json.header,dataList=data_json.records,dataListDefault=data_json.records,sortDataList=sort_data_json,isShowDetailLink=is_show_detail_link,detailLinkColor=detail_link_color,officialLinkColor=official_link_color,mSkew=mskew,resultTheme=result_theme,pickupCategory1=pickup_category1,pickupCategory2=pickup_category2,shouldShowPickup=Boolean(Number(should_show_pickup)),shouldShowStarRating=Boolean(Number(should_show_star_rating)),shouldShowResultDesc=Boolean(Number(should_show_result_desc)),"undefined"!=typeof should_auto_search&&(shouldAutoSearch=Boolean(Number(should_auto_search))),"undefined"!=typeof params_json&&resultSearchAndShow(params_json);var r=document.getElementsByClassName("search-form-accordion");for(t=0;t<r.length;t++)r[t].addEventListener("click",function(){this.parentElement.classList.toggle("search-form-active");var e=this.nextElementSibling;e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"})};